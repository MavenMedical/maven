#/bin/bash

cd /tmp
echo removing old nightly build dir to recreate it from scratch
if [ -d nightly_test ]; then
   echo rm -rf nightly_test
fi

#mkdir nightly_test
cd nightly_test

echo clone the repository
#git clone git@github.com:MavenMedical/maven.git
MAVEN_HOME=/tmp/nightly_test/maven
export MAVEN_HOME
PATH=${MAVEN_HOME}/env/bin:$PATH
cd ${MAVEN_HOME}

echo current and maven root directory is `pwd`

echo checking out the DEV branch
git checkout DEV

echo running tests, storing results in `pwd`/RESULTS
python unit_tests.py > RESULTS
cp RESULTS ~/NIGHTLY-RESULTS-`date "+%Y-%m-%d"`

# add to cron at 1am
# crontab -e
# 00 01 * * * /home/devel/maven/scripts_testing_benchmarking/nightly_tests